@model pingping.Common.AccLogin
@{
    ViewBag.Title = "MyAccount";
}

<link href="~/Content/bootstrap.min.css" rel="stylesheet" />
<!-- Start Contact -->
<section id="contact-us" class="contact-us section">
    <div class="container">
        <div class="contact-head">
            <div class="row">

                <div class="col-lg-4 col-12">
                    <div class="single-head">
                        <div class="form">
                            <div class="row">
                                <div class="title col-12" style="text-align:center">
                                    <h4>Thông Tin của tôi</h4>
                                </div>
                                <hr />
                                <div class="col-12">
                                    <div class="form-group">
                                        <label>Họ và Tên:</label>
                                        <span>@Model.hoten</span>
                                    </div>
                                </div>
                                <div class="col-12">
                                    <div class="form-group">
                                        <label>Tài Khoản:</label>
                                        <span>@Model.username</span>
                                    </div>
                                </div>
                                <div class="col-12">
                                    <div class="form-group">
                                        <label>Email:</label>
                                        <span>@Model.email</span>
                                    </div>
                                </div>
                                <div class="col-12">
                                    <div class="form-group">
                                        @{ if (Model.loaitk == false)
                                            {
                                                <label>Loại Tài Khoản:</label>
                                                <span>Người Bán</span>
                                            }
                                            else
                                            {
                                                <label>Loại Tài Khoản:</label>
                                                <span>Người Mua</span>
                                            }

                                        }

                                    </div>
                                </div>
                                <div class="col-12">
                                    <div class="form-group">
                                        <label>Số Điện Thoại:</label>
                                        <span>@Model.phone</span>
                                    </div>
                                </div>
                                <div class="col-12">
                                    <div class="form-group">
                                        <input type="button" class="btn btn" value="Thay đổi Thông Tin" id="btn1" />

                                    </div>
                                </div>
                                <div class="col-12">
                                    <div class="form-group">
                                        <input type="button" class="btn btn" value="Thay đổi Mật Khẩu" id="btn3" />
                                        <input type="button" class="btn btn-outline-danger" value="Đóng" style="display:none" id="btn2" />
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-8 col-12">
                    <div class="form-main" style="display:block" id="tk">
                        <div class="title">
                            <h4>Địa Chỉ Giao Hàng</h4>
                        </div>
                        <div class="@ViewBag.Alert">@ViewBag.notify</div>
                        <div class="form">
                            <div class="row">

                                <div class="col-lg-6 col-12">
                                    <div class="form-group">
                                        <label>Địa Chỉ</label>
                                        <input name="subject" type="text" value="@Model.street" readonly>
                                    </div>
                                </div>
                                <div class="col-lg-6 col-12">
                                    <div class="form-group">
                                        <label>Phường/Xã: </label>
                                        <input name="subject" type="text" value="@Model.ward" readonly>
                                    </div>
                                </div>
                                <div class="col-lg-6 col-12">
                                    <div class="form-group">
                                        <label>Quận/Huyện:</label>
                                        <input name="email" type="text" value="@Model.dictrict" readonly>
                                    </div>
                                </div>
                                <div class="col-lg-6 col-12">
                                    <div class="form-group">
                                        <label>Tỉnh/Thành Phố:</label>
                                        <input name="company_name" type="text" value="@Model.province" readonly>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="form-main" id="tktd" style="display:none">
                        <div class="title">
                            <h4>Thay đổi thông tin</h4>
                        </div>
                        @using (Html.BeginForm("ChangeAccounts", "Accounts", FormMethod.Post, new { @class = "form" }))
                        {
                            <div class="row">
                                <div class="col-12">
                                    <div class="form-group">
                                        <label>Họ và Tên:</label>
                                        @Html.TextBox("hoten", @Model.hoten, new { @class = "a" })
                                    </div>
                                </div>
                                <div class="col-lg-6 col-12">
                                    <div class="form-group">
                                        <label>Email:</label>
                                        @Html.TextBox("email", @Model.email)
                                    </div>
                                </div>
                                <div class="col-lg-6 col-12">
                                    <div class="form-group">
                                        <label>Địa Chỉ</label>
                                        @Html.TextBox("street", @Model.street)
                                    </div>
                                </div>
                                <div class="col-lg-6 col-12">
                                    <div class="form-group">
                                        <label>Phường/Xã: </label>
                                        @Html.TextBox("ward", @Model.ward)
                                    </div>
                                </div>
                                <div class="col-lg-6 col-12">
                                    <div class="form-group">
                                        <label>Quận/Huyện:</label>
                                        @Html.TextBox("dictrict", @Model.dictrict)
                                    </div>
                                </div>
                                <div class="col-lg-6 col-12">
                                    <div class="form-group">
                                        <label>Tỉnh/Thành Phố:</label>
                                        @Html.TextBox("province", @Model.province)
                                    </div>
                                </div>
                                <div class="col-lg-6 col-12">
                                    <div class="form-group">
                                        <label>Số Điện Thoại:</label>
                                        @Html.TextBox("phone", @Model.phone)
                                    </div>
                                </div>
                                <div class="col-12">
                                    <div class="form-group">
                                        <input name="company_name" class="btn-outline-success" type="submit" value="Sửa">
                                    </div>
                                </div>
                            </div>
                        }
                    </div>
                    <div class="form-main" id="tdmk" style="display:none">
                        <div class="title">
                            <h4>Thay đổi mật khẩu</h4>
                            <div id="TB_T" class="alert-danger"></div>
                        </div>
                        <p class="alert-danger" id="TB_MatKhau"></p>
                        @using (Html.BeginForm("ChangePassword", "Accounts", FormMethod.Post, new { @class = "form" }))
                        {
                            <div class="row">
                                <div class="col-12">
                                    <div class="form-group">
                                        <label>Mật khẩu hiện tại:</label>
                                        @Html.Password("password_old")
                                    </div>
                                </div>
                                <div class="col-lg-6 col-12">
                                    <div class="form-group">
                                        <label>Mật khẩu mới:</label>
                                        <input class="form-control" type="password" name="password" id="password" onkeyup="return passwordChanged();">
                                        <div class="text-muted font-italic"><small>Độ mạnh: <strong class="text-danger font-weight-700" id="strength">Chưa nhập mật khẩu</strong></small></div>
                                    </div>


                                </div>
                                <div class="col-lg-6 col-12">
                                    <div class="form-group">
                                        <label>Nhập lại mật khẩu:</label>
                                        @Html.Password("rpassword")
                                        <div><small><strong class="text-danger font-weight-700" id="TB_NLMK"></strong></small></div>
                                    </div>
                                </div>

                                <div class="col-12">
                                    <div class="form-group">
                                        <input name="company_name" class="btn-outline-success" id="btndoimatkhau" type="submit" value="Sửa Mật Khẩu" disabled>
                                    </div>
                                </div>
                            </div>
                        }
                    </div>
                </div>
            </div>
        </div>
    </div>

</section>
<style>
    .a {
        text-align: center;
    }
</style>
<script src="~/Scripts/jquery-3.3.1.min.js"></script>
<script>
    $(document).ready(function () {
        //hiden nav Product
        $('.all-category').hide();
    })
</script>
<script language="javascript">

    document.getElementById("btn1").onclick = function () {
        document.getElementById("tk").style.display = 'none';
        document.getElementById("tktd").style.display = 'block';
        document.getElementById("btn1").style.display = 'none';
        document.getElementById("btn2").style.display = 'block';
        document.getElementById("btn3").style.display = 'none';
    };
    document.getElementById("btn2").onclick = function () {
        document.getElementById("tk").style.display = 'block';
        document.getElementById("tktd").style.display = 'none';
        document.getElementById("btn1").style.display = 'block';
        document.getElementById("btn2").style.display = 'none';
        document.getElementById("btn3").style.display = 'block';
        document.getElementById("tdmk").style.display = 'none';
    };
    document.getElementById("btn3").onclick = function () {
        document.getElementById("tk").style.display = 'none';
        document.getElementById("btn1").style.display = 'none';
        document.getElementById("btn2").style.display = 'block';
        document.getElementById("btn3").style.display = 'none';
        document.getElementById("tdmk").style.display = 'block';
    };
    function passwordChanged() {
        var strength = document.getElementById('strength');
        var strongRegex = new RegExp("^(?=.{14,})(?=.*[A-Z])(?=.*[a-z])(?=.*[0-9])(?=.*\\W).*$", "g");
        var mediumRegex = new RegExp("^(?=.{10,})(((?=.*[A-Z])(?=.*[a-z]))|((?=.*[A-Z])(?=.*[0-9]))|((?=.*[a-z])(?=.*[0-9]))).*$", "g");
        var enoughRegex = new RegExp("(?=.{8,}).*", "g");
        var pwd = document.getElementById("password");
        if (pwd.value.length == 0) {
            strength.innerHTML = 'Chưa nhập mật khẩu';
        } else if (false == enoughRegex.test(pwd.value)) {
            strength.innerHTML = 'Chưa đủ kí tự';
        } else if (strongRegex.test(pwd.value)) {
            strength.innerHTML = '<span style="color:green">Tốt!</span>';
            document.getElementById("btndoimatkhau").disabled = false;
        } else if (mediumRegex.test(pwd.value)) {
            strength.innerHTML = '<span style="color:orange">Khá!</span>';
            document.getElementById("btndoimatkhau").disabled = false;
        } else {
            strength.innerHTML = '<span style="color:red">Yếu!</span>';
        }

    }
</script>
<script type="text/javascript">
    $("#btndoimatkhau").click(function () {
        var loi = 0;
        if ($("#rpassword").val() != $("#password").val()) {
            $("#TB_NLMK").text("Mật Khẩu không khớp!");
            return false;
        }
        else if ($("#password_old").val() == $("#password").val()) {
            $("#TB_T").text("Mật Khẩu không được trùng mật khẩu hiện tại!");
            return false;
        }
        else { return true; }
    });
</script>